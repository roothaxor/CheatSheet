<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <link href=https://roothaxor.github.io/images/love.png rel="shortcut icon" />
  <link rel="stylesheet" href="stylesheets/stylesheet.css" media="screen">
  <link rel="stylesheet" href="stylesheets/github-dark.css">
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="javascripts/script.js"></script>

  <title>Cheatsheet</title>
  <meta name="description" content="Metasploit CheatSheet ">

  <meta name="viewport" content="width=device-width,initial-scale=1">

</head>

<body>

  <div class="wrapper">
    <header>
      <h1 class="title">Cheatsheet</h1>
    </header>
    <div id="container">
      <p class="tagline">Metasploit CheatSheet With Brief Description </p>
      <div id="main" role="main">
        <div class="download-bar">
        <div class="inner">
          <a href="https://github.com/roothaxor/CheatSheet/tarball/master" class="download-button tar"><span>Download</span></a>
          <a href="https://github.com/roothaxor/CheatSheet/zipball/master" class="download-button zip"><span>Download</span></a>
          <a href="https://github.com/roothaxor/CheatSheet" class="code">View Cheatsheet on GitHub</a>
        </div>
        <span class="blc"></span><span class="trc"></span>
        </div>
        <article class="markdown-body">
          <p></p><h2>
<a id="meterpreter-commands-with-descriptions" class="anchor" href="#meterpreter-commands-with-descriptions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a id="jump-scriptcommandswithbriefdescriptions"></a>Meterpreter Commands with Descriptions</h2><ul>
<li>
<strong>arp_scanner.rb</strong> - Script for performing an ARP's Scan Discovery.</li> <li>
<strong>autoroute.rb</strong> - Meterpreter session without having to background the current session.</li> <li>
<strong>checkvm.rb</strong> - Script for detecting if target host is a virtual machine.</li> <li>
<strong>credcollect.rb</strong> - Script to harvest credentials found on the host and store them in the database.</li> <li>
<strong>domain_list_gen.rb</strong> - Script for extracting domain admin account list for use.</li> <li>
<strong>dumplinks.rb</strong> - Dumplinks parses .lnk files from a user's recent documents folder and Microsoft Office's Recent documents folder, if present. The .lnk files contain time stamps, file locations, including share names, volume serial #s and more. This info may help you target additional systems.</li> <li>
<strong>duplicate.rb</strong> - Uses a meterpreter session to spawn a new meterpreter session in a different process. A new process allows the session to take "risky" actions that might get the process killed by A/V, giving a meterpreter session to another controller, or start a keylogger on another process.</li> <li>
<strong>enum_chrome.rb</strong> - Script to extract data from a chrome installation.</li> <li>
<strong>enum_firefox.rb</strong> - Script for extracting data from Firefox. <strong>enum_logged_on_users.rb</strong> - Script for enumerating current logged users and users that have logged in to the system. <strong>enum_powershell_env.rb</strong> - Enumerates PowerShell and WSH configurations.</li> <li>
<strong>enum_putty.rb</strong> - Enumerates Putty connections.</li> <li>
<strong>enum_shares.rb</strong> - Script for Enumerating shares offered and history of mounted shares.</li> <li>
<strong>enum_vmware.rb</strong> - Enumerates VMware configurations for VMware products.</li> <li>
<strong>event_manager.rb</strong> - Show information about Event Logs on the target system and their configuration.</li> <li>
<strong>file_collector.rb</strong> - Script for searching and downloading files that match a specific pattern.</li> <li>
<strong>get_application_list.rb</strong> - Script for extracting a list of installed applications and their version.</li> <li>
<strong>getcountermeasure.rb</strong> - Script for detecting AV, HIPS, Third Party Firewalls, DEP Configuration and Windows Firewall configuration. Provides also the option to kill the processes of detected products and disable the built-in firewall.</li> <li>
<strong>get_env.rb</strong> - Script for extracting a list of all System and User environment variables.</li> <li>
<strong>getfilezillacreds.rb</strong> - Script for extracting servers and credentials from Filezilla.</li> <li>
<strong>getgui.rb</strong> - Script to enable Windows RDP.</li> <li>
<strong>get_local_subnets.rb</strong> - Get a list of local subnets based on the host's routes.</li> <li>
<strong>get_pidgen_creds.rb</strong> - Script for extracting configured services with username and passwords.</li> <li>
<strong>gettelnet.rb</strong> - Checks to see whether telnet is installed.</li> <li>
<strong>get_valid_community.rb</strong> - Gets a valid community string from SNMP.</li> <li>
<strong>getvncpw.rb</strong> - Gets the VNC password.</li> <li>
<strong>hashdump.rb</strong> - Grabs password hashes from the SAM.</li> <li>
<strong>hostedit.rb</strong> - Script for adding entries in to the Windows Hosts file.</li> <li>
<strong>keylogrecorder.rb</strong> - Script for running keylogger and saving all the keystrokes.</li> <li>
<strong>killav.rb</strong> - Terminates nearly every antivirus software on victim.</li> <li>
<strong>metsvc.rb</strong> - Delete one meterpreter service and start another.</li> <li>
<strong>migrate</strong> - Moves the meterpreter service to another process.</li> <li>
<strong>multicommand.rb</strong> - Script for running multiple commands on Windows 2003, Windows Vistaand Windows XP and Windows 2008 targets.</li> <li>
<strong>multi_console_command.rb</strong> - Script for running multiple console commands on a meterpreter session.</li> <li>
<strong>multi_meter_inject.rb</strong> - Script for injecting a reverce tcp Meterpreter Payload into memory of multiple PIDs, if none is provided a notepad process will be created and a Meterpreter Payload will be injected in to each.</li> <li>
<strong>multiscript.rb</strong> - Script for running multiple scripts on a Meterpreter session.</li> <li>
<strong>netenum.rb</strong> - Script for ping sweeps on Windows 2003, Windows Vista, Windows 2008 and Windows XP targets using native Windows commands.</li> <li>
<strong>packetrecorder.rb</strong> - Script for capturing packets in to a PCAP file.</li> <li>
<strong>panda2007pavsrv51.rb</strong> - This module exploits a privilege escalation vulnerability in Panda Antivirus 2007. Due to insecure permission issues, a local attacker can gain elevated privileges.</li> <li>
<strong>persistence.rb</strong> - Script for creating a persistent backdoor on a target host.</li> <li>
<strong>pml_driver_config.rb</strong> - Exploits a privilege escalation vulnerability in Hewlett-Packard's PML Driver HPZ12. Due to an insecure SERVICE_CHANGE_CONFIG DACL permission, a local attacker can gain elevated privileges.</li> <li>
<strong>powerdump.rb</strong> - Meterpreter script for utilizing purely PowerShell to extract username and password hashes through registry keys. This script requires you to be running as system in order to work properly. This has currently been tested on Server 2008 and Windows 7, which installs PowerShell by default.</li> <li>
<strong>prefetchtool.rb</strong> - Script for extracting information from windows prefetch folder.</li> <li>
<strong>process_memdump.rb</strong> - Script is based on the paper Neurosurgery With Meterpreter.</li> <li>
<strong>remotewinenum.rb</strong> - This script will enumerate windows hosts in the target environment given a username and password or using the credential under which Meterpeter is running using WMI wmic windows native tool.</li> <li>
<strong>scheduleme.rb</strong> - Script for automating the most common scheduling tasks during a pentest. This script works with Windows XP, Windows 2003, Windows Vista and Windows 2008.</li> <li>
<strong>schelevator.rb</strong> - Exploit for Windows Vista/7/2008 Task Scheduler 2.0 Privilege Escalation. This script exploits the Task Scheduler 2.0 XML 0day exploited by Stuxnet.</li> <li>
<strong>schtasksabuse.rb</strong> - Meterpreter script for abusing the scheduler service in Windows by scheduling and running a list of command against one or more targets. Using schtasks command to run them as system. This script works with Windows XP, Windows 2003, Windows Vista and Windows 2008.</li> <li>
<strong>scraper.rb</strong> - The goal of this script is to obtain system information from a victim through an existing Meterpreter session.</li> <li>
<strong>screenspy.rb</strong> - This script will open an interactive view of remote hosts. You will need Firefox installed on your machine.</li> <li>
<strong>screen_unlock.rb</strong> - Script to unlock a windows screen. Needs system privileges to run and known signatures for the target system.</li> <li>
<strong>screen_dwld.rb</strong> - Script that recursively search and download files matching a given pattern.</li> <li>
<strong>service_manager.rb</strong> - Script for managing Windows services.</li> <li>
<strong>service_permissions_escalate.rb</strong> This script attempts to create a service, then searches through a list of existing services to look for insecure file or configuration permissions that will let it replace the executable with a payload. It will then attempt to restart the replaced service to run the payload. If that fails, the next time the service is started (such as on reboot) the attacker will gain elevated privileges.</li> <li>
<strong>sound_recorder.rb</strong> - Script for recording in intervals the sound capture by a target host microphone.</li> <li>
<strong>srt_webdrive_priv.rb</strong> - Exploits a privilege escalation vulnerability in South River Technologies WebDrive.</li> <li>
<strong>uploadexec.rb</strong> - Script to upload executable file to host.</li> <li>
<strong>virtualbox_sysenter_dos</strong> - Script to DoS Virtual Box.</li> <li>
<strong>virusscan_bypass.rb</strong> - Script that kills Mcafee VirusScan Enterprise v8.7.0i+ processes.</li> <li>
<strong>vnc.rb</strong> - Meterpreter script for obtaining a quick VNC session.</li> <li>
<strong>webcam.rb</strong> - Script to enable and capture images from the host webcam.</li> <li>
<strong>win32-sshclient.rb</strong> - Script to deploy &amp; run the "plink" commandline ssh-client. Supports only MS-Windows-2k/XP/Vista Hosts.</li> <li>
<strong>win32-sshserver.rb</strong> - Script to deploy and run OpenSSH on the target machine.</li> <li>
<strong>winbf.rb</strong> - Function for checking the password policy of current system. This policy may resemble the policy of other servers in the target environment.</li> <li>
<strong>winenum.rb</strong> - Enumerates Windows system including environment variables, network interfaces, routing, user accounts, etc</li> <li>
<strong>wmic.rb</strong> - Script for running WMIC commands on Windows 2003, Windows Vista and Windows XP and Windows 2008 targets.</li>
</ul> 
<br><br>
<h2>
<a id="metasploits-meterpreter-cheat-sheet" class="anchor" href="#metasploits-meterpreter-cheat-sheet" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a id="jump-step1"></a>Metasploits Meterpreter Cheat Sheet</h2><ul>
<li>
<strong>?</strong> - help menu</li> <li>
<strong>background</strong> - moves the current session to the background</li> <li>
<strong>bgkill</strong> - kills a background meterpreter script</li> <li>
<strong>bglist</strong> - provides a list of all running background scripts</li> <li>
<strong>bgrun</strong> - runs a script as a background thread</li> <li>
<strong>channel</strong> - displays active channels</li> <li>
<strong>close</strong> - closes a channel</li> <li>
<strong>exit</strong> - terminates a meterpreter session</li> <li>
<strong>help</strong> - help menu</li> <li>
<strong>interact</strong> - interacts with a channel</li> <li>
<strong>irb</strong> - go into Ruby scripting mode</li> <li>
<strong>migrate</strong> - moves the active process to a designated PID</li> <li>
<strong>quit</strong> - terminates the meterpreter session</li> <li>
<strong>read</strong> - reads the data from a channel</li> <li>
<strong>run</strong> - executes the meterpreter script designated after it</li> <li>
<strong>use</strong> - loads a meterpreter extension</li> <li>
<strong>write</strong> - writes data to a channel</li>
</ul>

<p></p><h2>
<a id="file-system-commands" class="anchor" href="#file-system-commands" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a id="jump-step2"></a>File System Commands</h2><ul>
<li>
<strong>cat</strong> - read and output to stdout the contents of a file</li> <li>
<strong>cd</strong> - change directory on the victim</li> <li>
<strong>del</strong> - delete a file on the victim</li> <li>
<strong>download</strong> - download a file from the victim system to the attacker system</li> <li>
<strong>edit</strong> - edit a file with vim</li> <li>
<strong>getlwd</strong> - print the local directory</li> <li>
<strong>getwd</strong> - print working directory</li> <li>
<strong>lcd</strong> - change local directory</li> <li>
<strong>lpwd</strong> - print local directory</li> <li>
<strong>ls</strong> - list files in current directory</li> <li>
<strong>mkdir</strong> - make a directory on the victim system</li> <li>
<strong>pwd</strong> - print working directory</li> <li>
<strong>rm</strong> - delete a file</li> <li>
<strong>rmdir</strong> - remove directory on the victim system</li> <li>
<strong>upload</strong> - upload a file from the attacker system to the victim</li>
</ul>

<p></p><h2>
<a id="networking-commands" class="anchor" href="#networking-commands" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a id="jump-step3"></a>Networking Commands</h2><ul>
<li>
<strong>ipconfig</strong> - displays network interfaces with key information including IP address, etc.</li> <li>
<strong>portfwd</strong> - forwards a port on the victim system to a remote service</li> <li>
<strong>route</strong> - view or modify the victim routing table</li>
</ul>

<p></p><h2>
<a id="system-commands" class="anchor" href="#system-commands" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a id="jump-step4"></a>System Commands</h2><ul>
<li>
<strong>clearav</strong> - clears the event logs on the victim's computer</li> <li>
<strong>drop_token</strong> - drops a stolen token</li> <li>
<strong>execute</strong> - executes a command</li> <li>
<strong>getpid</strong> - gets the current process ID (PID)</li> <li>
<strong>getprivs</strong> - gets as many privileges as possible</li> <li>
<strong>getuid</strong> - get the user that the server is running as</li> <li>
<strong>kill</strong> - terminate the process designated by the PID</li> <li>
<strong>ps</strong> - list running processes</li> <li>
<strong>reboot</strong> - reboots the victim computer</li> <li>
<strong>reg</strong> - interact with the victim's registry</li> <li>
<strong>rev2self</strong> - calls RevertToSelf() on the victim machine</li> <li>
<strong>shell</strong> - opens a command shell on the victim machine</li> <li>
<strong>shutdown</strong> - shuts down the victim's computer</li> <li>
<strong>steal_token</strong> - attempts to steal the token of a specified (PID) process</li> <li>
<strong>sysinfo</strong> - gets the details about the victim computer such as OS and name</li>
</ul>

<p></p><h2>
<a id="user-interface-commands" class="anchor" href="#user-interface-commands" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a id="jump-step5"></a>User Interface Commands</h2><ul>
<li>
<strong>enumdesktops</strong> - lists all accessible desktops</li> <li>
<strong>getdesktop</strong> - get the current meterpreter desktop</li> <li>
<strong>idletime</strong> - checks to see how long since the victim system has been idle</li> <li>
<strong>keyscan_dump</strong> - dumps the contents of the software keylogger</li> <li>
<strong>keyscan_start</strong> - starts the software keylogger when associated with a process such as Word or browser</li> <li>
<strong>keyscan_stop</strong> - stops the software keylogger</li> <li>
<strong>screenshot</strong> - grabs a screenshot of the meterpreter desktop</li> <li>
<strong>set_desktop</strong> - changes the meterpreter desktop</li> <li>
<strong>uictl</strong> - enables control of some of the user interface components</li>
</ul>

<p></p><h2>
<a id="privilege-escalation-commands" class="anchor" href="#privilege-escalation-commands" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a id="jump-step6"></a>Privilege Escalation Commands</h2><ul><li>
<strong>getsystem</strong> - uses 15 built-in methods to gain sysadmin privileges</li></ul>

<p></p><h2>
<a id="password-dump-commands" class="anchor" href="#password-dump-commands" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a id="jump-step7"></a>Password Dump Commands</h2><ul>
<li>
<strong>hashdump</strong> - grabs the hashes in the password (SAM) file</li> </ul><p>Note that hashdump will often trip AV software, but there are now two scripts that are more stealthy, "run hashdump" and "run smart_hashdump". Look for more on those on my upcoming meterpreter script cheat sheet.</p>

<p></p><h2>
<a id="timestomp-commands" class="anchor" href="#timestomp-commands" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a id="jump-step8"></a>Timestomp Commands</h2><ul><li>
<strong>timestomp</strong> - manipulates the modify, access, and create attributes of a file</li></ul>

<h2>Various Work Commands Update !</h2><ul><li>
<strong>resource /path/../script.rc</strong> - .rc file execution in meterpreter for post exploitation</li><li>
<strong>msfconsole -r /path/../script.rc</strong> - use .rc script in beginning</li> <li>
<strong>unset</strong> - Unset everything done by script or command</li> <li>
<strong>ruby execution</strong> - Put .rb code in .rc using "<ruby>ruby code here</ruby>" file to run in meterpreter. example above to execute .rc file</li> <li>
<strong>mof_persist</strong> - Persistence with antivirus bypass</li></ul>


        </article>
      </div>
    </div>
    <footer>
      <div class="owner">
      <p><a href="https://github.com/roothaxor" class="avatar"><img src="https://avatars1.githubusercontent.com/u/17362843?v=3&amp;s=60" width="48" height="48"></a> <a href="https://github.com/roothaxor">roothaxor</a> maintains <a href="https://github.com/roothaxor/CheatSheet">Cheatsheet</a></p>


      </div>
      <div class="creds">
        <small>Follow @ <a href="https://twitter.com/root_haxor/">Twitter Profile</a><br>Facebook <a href="https://www.facebook.com/ro0tHax0r">RooT HaXor</a></small>
      </div>
    </footer>
  </div>
  <div class="current-section">
    <a href="#top">Scroll to top</a>
    <a href="https://github.com/roothaxor/CheatSheet/tarball/master" class="tar">tar</a><a href="https://github.com/roothaxor/CheatSheet/zipball/master" class="zip">zip</a><a href="" class="code">source code</a>
    <p class="name"></p>
  </div>

  
</body>
</html>
